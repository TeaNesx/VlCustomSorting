(function(){var t={593:function(){Shopware.Component.override("sw-category-detail-products",{mounted(){this.$options.extends&&this.$options.extends.methods&&this.$options.extends.methods.mounted&&this.$options.extends.methods.mounted.call(this),setTimeout(()=>{this.addSortOrderInputFields()},1e3)},updated(){this.$options.extends&&this.$options.extends.methods&&this.$options.extends.methods.updated&&this.$options.extends.methods.updated.call(this),setTimeout(()=>{this.addSortOrderInputFields()},500)},computed:{productColumns(){let t=this.$super("productColumns");return t.push({property:"sortOrder",dataIndex:"sortOrder",label:this.$tc("vl-custom-sorting.columns.sortOrder"),inlineEdit:"string",allowResize:!0,align:"right",width:"125px",visible:!0}),t},gridComponent(){if(this.$children){for(let t of this.$children)if("sw-many-to-many-assignment-card"===t.$options.name)return t}return null},products(){return this.gridComponent&&this.gridComponent.items?this.gridComponent.items:[]}},methods:{addSortOrderInputFields(){let t=document.querySelectorAll(".sw-data-grid__cell--sortOrder .sw-data-grid__cell-content");t.length&&t.forEach(t=>{if(t.querySelector("input"))return;let e=t.closest(".sw-data-grid__row");if(!e)return;let r=this.getProductIdFromRow(e);if(!r)return;let o=this.getProductSortOrder(r);t.innerHTML="";let s=document.createElement("input");s.type="text",s.className="sw-field__input",s.value=o||"",s.style.width="100%",s.style.height="32px",s.style.padding="0 10px",s.style.border="1px solid #d1d9e0",s.style.borderRadius="4px",s.addEventListener("change",t=>{this.saveSortOrder(r,t.target.value)}),t.appendChild(s)})},getProductIdFromRow(t){let e=t.querySelector(".sw-data-grid__cell--name a");if(e&&e.href){let t=e.href.match(/\/sw\/product\/detail\/([a-f0-9]+)/);if(t&&t[1])return t[1]}return null},getProductSortOrder(t){if(this.products&&this.products.length){let e=this.products.find(e=>e.id===t);if(e)return e.sortOrder}return null},saveSortOrder(t,e){let r=Shopware.Service("repositoryFactory").create("product");r.get(t,Shopware.Context.api).then(t=>(t.sortOrder=e,r.save(t,Shopware.Context.api))).then(()=>{Shopware.State.dispatch("notification/createNotification",{title:"Erfolg",message:"Sortierung wurde gespeichert",variant:"success"}),this.updateProductInGrid(t,e),this.gridComponent&&"function"==typeof this.gridComponent.getList&&this.gridComponent.getList()}).catch(t=>{console.error("Error saving sort order:",t),Shopware.State.dispatch("notification/createNotification",{title:"Fehler",message:"Fehler beim Speichern der Sortierung",variant:"error"})})},updateProductInGrid(t,e){if(this.products&&this.products.length){let r=this.products.find(e=>e.id===t);r&&(r.sortOrder=e)}if(this.gridComponent&&this.gridComponent.items&&this.gridComponent.items.length){let r=this.gridComponent.items.find(e=>e.id===t);r&&(r.sortOrder=e)}if(this.$parent&&this.$parent.products&&this.$parent.products.length){let r=this.$parent.products.find(e=>e.id===t);r&&(r.sortOrder=e)}}}})}},e={};function r(o){var s=e[o];if(void 0!==s)return s.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,r),i.exports}r.p="bundles/vlcustomsorting/",window?.__sw__?.assetPath&&(r.p=window.__sw__.assetPath+"/bundles/vlcustomsorting/"),Shopware.Component.override("sw-category-detail-products",{template:'{% block sw_category_detail_products %}\n    {% parent %}\n{% endblock %}\n\n{% block sw_many_to_many_assignment_card_grid_columns %}\n    {% parent %}\n\n    <template slot="column-sortOrder" slot-scope="{ item }">\n        <input \n            type="text" \n            class="sw-field__input" \n            :value="item.sortOrder"\n            @input="item.sortOrder = $event.target.value"\n            @change="onSortOrderChange(item)"\n            style="width: 100%; height: 32px; padding: 0 10px; border: 1px solid #d1d9e0; border-radius: 4px;"\n        />\n    </template>\n{% endblock %}',computed:{productColumns(){let t=this.$super("productColumns");return t.push({property:"sortOrder",dataIndex:"sortOrder",label:this.$tc("vl-custom-sorting.columns.sortOrder"),inlineEdit:"string",allowResize:!0,align:"right",width:"125px",visible:!0}),t}},created(){this.$on("sw-many-to-many-assignment-card-criteria-loaded",this.onCriteriaLoaded)},beforeDestroy(){this.$off("sw-many-to-many-assignment-card-criteria-loaded",this.onCriteriaLoaded)},methods:{onCriteriaLoaded(t){t.hasField("product.sortOrder")||t.addSelect("product.sortOrder")},onSortOrderChange(t){t&&t.id&&this.repositoryFactory.create("product").save(t,Shopware.Context.api).then(()=>{this.createNotificationSuccess({message:this.$tc("vl-custom-sorting.messages.sortOrderSaved",0,{name:t.name})})}).catch(e=>{this.createNotificationError({message:this.$tc("vl-custom-sorting.messages.sortOrderError",0,{name:t.name})})})}}}),r(593),Shopware.Locale.extend("de-DE",{"vl-custom-sorting":{columns:{sortOrder:"Sortierung"},messages:{sortOrderSaved:'Sortierung f\xfcr "{name}" wurde erfolgreich gespeichert',sortOrderError:'Fehler beim Speichern der Sortierung f\xfcr "{name}"'}}}),Shopware.Locale.extend("en-GB",{"vl-custom-sorting":{columns:{sortOrder:"Sort Order"},messages:{sortOrderSaved:'Sort order for "{name}" has been saved successfully',sortOrderError:'Error saving sort order for "{name}"'}}})})();